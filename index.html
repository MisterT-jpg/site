<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Cooldown Champions LoL</title>
</head>
<body>
    <h2 id="sort">Chargement...</h2>

    <input type="text" id="cdInput" placeholder="Entrer le CD">
    <button onclick="verifier()">Vérifier</button>
    <button onclick="reessayer()">Réessayer</button>

    <p id="resultat"></p>

    <script>
        let allSpells = {};
        let currentSpell = { name: "", cd: "" };

        async function chargerSort() {
            if (Object.keys(allSpells).length === 0) {
                const res = await fetch("data/championFull.json");
                const json = await res.json();
                const champions = json.data;

                for (const champKey in champions) {
                    const champ = champions[champKey];
                    const spells = champ.spells;

                    if (spells.length === 4) {
                        allSpells[champ.name + " Q"] = spells[0].cooldown[0];
                        allSpells[champ.name + " W"] = spells[1].cooldown[0];
                        allSpells[champ.name + " E"] = spells[2].cooldown[0];
                        allSpells[champ.name + " R"] = spells[3].cooldown[0];
                    }
                }
            }

            const keys = Object.keys(allSpells);
            const randomKey = keys[Math.floor(Math.random() * keys.length)];
            const cd = allSpells[randomKey];

            currentSpell = {
                name: randomKey,
                cd: cd.toString()
            };

            document.getElementById("sort").innerText = randomKey;
            document.getElementById("resultat").innerText = "";
        }

        function verifier() {
            const cd = document.getElementById("cdInput").value.trim();
            if (cd === currentSpell.cd) {
                document.getElementById("resultat").innerText = "✅ Correct !";
            } else {
                document.getElementById("resultat").innerText = `❌ Faux. Le CD correct était : ${currentSpell.cd}`;
            }
        }

        function reessayer() {
            chargerSort();
            document.getElementById("cdInput").value = "";
        }

        window.onload = chargerSort;
    </script>
</body>
</html>
